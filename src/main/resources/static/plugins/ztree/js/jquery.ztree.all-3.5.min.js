(function(z){var H={},I={},E={},x={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0,txtSelectedEnable:!1},data:{key:{children:"children",name:"name",title:"",url:"url",icon:"icon"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},q=[function(n){var d=n.treeObj,b=p.event;d.bind(b.NODECREATED,function(d,b,a){e.apply(n.callback.onNodeCreated,[d,b,a])});d.bind(b.CLICK,function(d,b,a,G,c){e.apply(n.callback.onClick,[b,a,G,c])});d.bind(b.EXPAND,function(d,b,a){e.apply(n.callback.onExpand,[d,b,a])});d.bind(b.COLLAPSE,function(d,b,a){e.apply(n.callback.onCollapse,[d,b,a])});d.bind(b.ASYNC_SUCCESS,function(d,b,a,G){e.apply(n.callback.onAsyncSuccess,[d,b,a,G])});d.bind(b.ASYNC_ERROR,function(d,b,a,G,c,f){e.apply(n.callback.onAsyncError,[d,b,a,G,c,f])});d.bind(b.REMOVE,function(d,b,a){e.apply(n.callback.onRemove,[d,b,a])});d.bind(b.SELECTED,function(d,b,a){e.apply(n.callback.onSelected,[b,a])});d.bind(b.UNSELECTED,function(d,b,a){e.apply(n.callback.onUnSelected,[b,a])})}],h=[function(n){var d=p.event;n.treeObj.unbind(d.NODECREATED).unbind(d.CLICK).unbind(d.EXPAND).unbind(d.COLLAPSE).unbind(d.ASYNC_SUCCESS).unbind(d.ASYNC_ERROR).unbind(d.REMOVE).unbind(d.SELECTED).unbind(d.UNSELECTED)}],t=[function(n){var d=b.getCache(n);d||(d={},b.setCache(n,d));d.nodes=[];d.doms=[]}],r=[function(n,d,a,g,c,f,l){if(a){l=b.getRoot(n);var m=n.data.key.children;a.level=d;a.tId=n.treeId+"_"+ ++l.zId;a.parentTId=g?g.tId:null;a.open="string"==typeof a.open?e.eqs(a.open,"true"):!!a.open;a[m]&&0<a[m].length?(a.isParent=!0,a.zAsync=!0):(a.isParent="string"==typeof a.isParent?e.eqs(a.isParent,"true"):!!a.isParent,a.open=a.isParent&&!n.async.enable?a.open:!1,a.zAsync=!a.isParent);a.isFirstNode=c;a.isLastNode=f;a.getParentNode=function(){return b.getNodeCache(n,a.parentTId)};a.getPreNode=function(){return b.getPreNode(n,a)};a.getNextNode=function(){return b.getNextNode(n,a)};a.isAjaxing=!1;b.fixPIdKeyValue(n,a)}}],v=[function(n){var d=n.target,a=b.getSetting(n.data.treeId),g="",c=null,f="",l="",k=null,q=null,h=null;if(e.eqs(n.type,"mousedown"))l="mousedown";else if(e.eqs(n.type,"mouseup"))l="mouseup";else if(e.eqs(n.type,"contextmenu"))l="contextmenu";else if(e.eqs(n.type,"click"))if(e.eqs(d.tagName,"span")&&null!==d.getAttribute("treeNode"+p.id.SWITCH))g=e.getNodeMainDom(d).id,f="switchNode";else{if(h=e.getMDom(a,d,[{tagName:"a",attrName:"treeNode"+p.id.A}]))g=e.getNodeMainDom(h).id,f="clickNode"}else e.eqs(n.type,"dblclick")&&(l="dblclick",h=e.getMDom(a,d,[{tagName:"a",attrName:"treeNode"+p.id.A}]))&&(g=e.getNodeMainDom(h).id,f="switchNode");0<l.length&&0==g.length&&(h=e.getMDom(a,d,[{tagName:"a",attrName:"treeNode"+p.id.A}]))&&(g=e.getNodeMainDom(h).id);if(0<g.length)switch(c=b.getNodeCache(a,g),f){case "switchNode":c.isParent?e.eqs(n.type,"click")||e.eqs(n.type,"dblclick")&&e.apply(a.view.dblClickExpand,[a.treeId,c],a.view.dblClickExpand)?k=m.onSwitchNode:f="":f="";break;case "clickNode":k=m.onClickNode}switch(l){case "mousedown":q=m.onZTreeMousedown;break;case "mouseup":q=m.onZTreeMouseup;break;case "dblclick":q=m.onZTreeDblclick;break;case "contextmenu":q=m.onZTreeContextmenu}return{stop:!1,node:c,nodeEventType:f,nodeEventCallback:k,treeEventType:l,treeEventCallback:q}}],B=[function(n){var d=b.getRoot(n);d||(d={},b.setRoot(n,d));d[n.data.key.children]=[];d.expandTriggerFlag=!1;d.curSelectedList=[];d.noSelection=!0;d.createdNodes=[];d.zId=0;d._ver=(new Date).getTime()}],M=[],K=[],L=[],k=[],a=[],b={addNodeCache:function(n,d){b.getCache(n).nodes[b.getNodeCacheId(d.tId)]=d},getNodeCacheId:function(n){return n.substring(n.lastIndexOf("_")+1)},addAfterA:function(n){K.push(n)},addBeforeA:function(n){M.push(n)},addInnerAfterA:function(n){k.push(n)},addInnerBeforeA:function(n){L.push(n)},addInitBind:function(n){q.push(n)},addInitUnBind:function(n){h.push(n)},addInitCache:function(n){t.push(n)},addInitNode:function(n){r.push(n)},addInitProxy:function(n,d){d?v.splice(0,0,n):v.push(n)},addInitRoot:function(n){B.push(n)},addNodesData:function(n,d,a){var b=n.data.key.children;d[b]||(d[b]=[]);0<d[b].length&&(d[b][d[b].length-1].isLastNode=!1,f.setNodeLineIcos(n,d[b][d[b].length-1]));d.isParent=!0;d[b]=d[b].concat(a)},addSelectedNode:function(n,d){var a=b.getRoot(n);b.isSelectedNode(n,d)||a.curSelectedList.push(d)},addCreatedNode:function(n,d){(n.callback.onNodeCreated||n.view.addDiyDom)&&b.getRoot(n).createdNodes.push(d)},addZTreeTools:function(n){a.push(n)},exSetting:function(n){z.extend(!0,x,n)},fixPIdKeyValue:function(n,d){n.data.simpleData.enable&&(d[n.data.simpleData.pIdKey]=d.parentTId?d.getParentNode()[n.data.simpleData.idKey]:n.data.simpleData.rootPId)},getAfterA:function(n,d,a){for(var b=0,c=K.length;b<c;b++)K[b].apply(this,arguments)},getBeforeA:function(n,d,b){for(var a=0,c=M.length;a<c;a++)M[a].apply(this,arguments)},getInnerAfterA:function(n,d,a){for(var b=0,c=k.length;b<c;b++)k[b].apply(this,arguments)},getInnerBeforeA:function(n,d,b){for(var a=0,c=L.length;a<c;a++)L[a].apply(this,arguments)},getCache:function(n){return E[n.treeId]},getNextNode:function(n,d){if(!d)return null;for(var a=n.data.key.children,g=d.parentTId?d.getParentNode():b.getRoot(n),c=0,f=g[a].length-1;c<=f;c++)if(g[a][c]===d)return c==f?null:g[a][c+1];return null},getNodeByParam:function(n,d,a,g){if(!d||!a)return null;for(var c=n.data.key.children,f=0,e=d.length;f<e;f++){if(d[f][a]==g)return d[f];var l=b.getNodeByParam(n,d[f][c],a,g);if(l)return l}return null},getNodeCache:function(n,d){if(!d)return null;var a=E[n.treeId].nodes[b.getNodeCacheId(d)];return a?a:null},getNodeName:function(n,d){return""+d[n.data.key.name]},getNodeTitle:function(n,d){return""+d[""===n.data.key.title?n.data.key.name:n.data.key.title]},getNodes:function(n){return b.getRoot(n)[n.data.key.children]},getNodesByParam:function(n,d,a,c){if(!d||!a)return[];for(var u=n.data.key.children,f=[],e=0,l=d.length;e<l;e++)d[e][a]==c&&f.push(d[e]),f=f.concat(b.getNodesByParam(n,d[e][u],a,c));return f},getNodesByParamFuzzy:function(n,d,a,c){if(!d||!a)return[];var u=n.data.key.children,f=[];c=c.toLowerCase();for(var e=0,l=d.length;e<l;e++)"string"==typeof d[e][a]&&-1<d[e][a].toLowerCase().indexOf(c)&&f.push(d[e]),f=f.concat(b.getNodesByParamFuzzy(n,d[e][u],a,c));return f},getNodesByFilter:function(n,d,a,c,u){if(!d)return c?null:[];for(var f=n.data.key.children,l=c?null:[],m=0,p=d.length;m<p;m++){if(e.apply(a,[d[m],u],!1)){if(c)return d[m];l.push(d[m])}var k=b.getNodesByFilter(n,d[m][f],a,c,u);if(c&&k)return k;l=c?k:l.concat(k)}return l},getPreNode:function(n,d){if(!d)return null;for(var a=n.data.key.children,c=d.parentTId?d.getParentNode():b.getRoot(n),u=0,f=c[a].length;u<f;u++)if(c[a][u]===d)return 0==u?null:c[a][u-1];return null},getRoot:function(n){return n?I[n.treeId]:null},getRoots:function(){return I},getSetting:function(n){return H[n]},getSettings:function(){return H},getZTreeTools:function(n){return(n=this.getRoot(this.getSetting(n)))?n.treeTools:null},initCache:function(n){for(var d=0,a=t.length;d<a;d++)t[d].apply(this,arguments)},initNode:function(n,d,a,b,c,f){for(var e=0,l=r.length;e<l;e++)r[e].apply(this,arguments)},initRoot:function(n){for(var d=0,a=B.length;d<a;d++)B[d].apply(this,arguments)},isSelectedNode:function(n,d){for(var a=b.getRoot(n),c=0,u=a.curSelectedList.length;c<u;c++)if(d===a.curSelectedList[c])return!0;return!1},removeNodeCache:function(n,d){var a=n.data.key.children;if(d[a])for(var c=0,u=d[a].length;c<u;c++)arguments.callee(n,d[a][c]);b.getCache(n).nodes[b.getNodeCacheId(d.tId)]=null},removeSelectedNode:function(n,d){for(var a=b.getRoot(n),c=0,u=a.curSelectedList.length;c<u;c++)d!==a.curSelectedList[c]&&b.getNodeCache(n,a.curSelectedList[c].tId)||(a.curSelectedList.splice(c,1),n.treeObj.trigger(p.event.UNSELECTED,[n.treeId,d]),c--,u--)},setCache:function(a,d){E[a.treeId]=d},setRoot:function(a,d){I[a.treeId]=d},setZTreeTools:function(n,d){for(var b=0,c=a.length;b<c;b++)a[b].apply(this,arguments)},transformToArrayFormat:function(a,d){if(!d)return[];var c=a.data.key.children,g=[];if(e.isArray(d))for(var u=0,f=d.length;u<f;u++)g.push(d[u]),d[u][c]&&(g=g.concat(b.transformToArrayFormat(a,d[u][c])));else g.push(d),d[c]&&(g=g.concat(b.transformToArrayFormat(a,d[c])));return g},transformTozTreeFormat:function(a,d){var b,c,u=a.data.simpleData.idKey,f=a.data.simpleData.pIdKey,l=a.data.key.children;if(!u||""==u||!d)return[];if(e.isArray(d)){var m=[],p=[];b=0;for(c=d.length;b<c;b++)p[d[b][u]]=d[b];b=0;for(c=d.length;b<c;b++)p[d[b][f]]&&d[b][u]!=d[b][f]?(p[d[b][f]][l]||(p[d[b][f]][l]=[]),p[d[b][f]][l].push(d[b])):m.push(d[b]);return m}return[d]}},c={bindEvent:function(a){for(var d=0,b=q.length;d<b;d++)q[d].apply(this,arguments)},unbindEvent:function(a){for(var d=0,b=h.length;d<b;d++)h[d].apply(this,arguments)},bindTree:function(a){var d={treeId:a.treeId},b=a.treeObj;a.view.txtSelectedEnable||b.bind("selectstart",function(d){d=d.originalEvent.srcElement.nodeName.toLowerCase();return"input"===d||"textarea"===d}).css({"-moz-user-select":"-moz-none"});b.bind("click",d,c.proxy);b.bind("dblclick",d,c.proxy);b.bind("mouseover",d,c.proxy);b.bind("mouseout",d,c.proxy);b.bind("mousedown",d,c.proxy);b.bind("mouseup",d,c.proxy);b.bind("contextmenu",d,c.proxy)},unbindTree:function(a){a.treeObj.unbind("click",c.proxy).unbind("dblclick",c.proxy).unbind("mouseover",c.proxy).unbind("mouseout",c.proxy).unbind("mousedown",c.proxy).unbind("mouseup",c.proxy).unbind("contextmenu",c.proxy)},doProxy:function(a){for(var d=[],b=0,c=v.length;b<c;b++){var f=v[b].apply(this,arguments);d.push(f);if(f.stop)break}return d},proxy:function(a){var d=b.getSetting(a.data.treeId);if(!e.uCanDo(d,a))return!0;for(var d=c.doProxy(a),G=!0,g=0,f=d.length;g<f;g++){var l=d[g];l.nodeEventCallback&&(G=l.nodeEventCallback.apply(l,[a,l.node])&&G);l.treeEventCallback&&(G=l.treeEventCallback.apply(l,[a,l.node])&&G)}return G}},m={onSwitchNode:function(a,d){var c=b.getSetting(a.data.treeId);if(d.open){if(0==e.apply(c.callback.beforeCollapse,[c.treeId,d],!0))return!0}else if(0==e.apply(c.callback.beforeExpand,[c.treeId,d],!0))return!0;b.getRoot(c).expandTriggerFlag=!0;f.switchNode(c,d);return!0},onClickNode:function(a,d){var c=b.getSetting(a.data.treeId),g=c.view.autoCancelSelected&&(a.ctrlKey||a.metaKey)&&b.isSelectedNode(c,d)?0:c.view.autoCancelSelected&&(a.ctrlKey||a.metaKey)&&c.view.selectedMulti?2:1;if(0==e.apply(c.callback.beforeClick,[c.treeId,d,g],!0))return!0;0===g?f.cancelPreSelectedNode(c,d):f.selectNode(c,d,2===g);c.treeObj.trigger(p.event.CLICK,[a,c.treeId,d,g]);return!0},onZTreeMousedown:function(a,d){var c=b.getSetting(a.data.treeId);e.apply(c.callback.beforeMouseDown,[c.treeId,d],!0)&&e.apply(c.callback.onMouseDown,[a,c.treeId,d]);return!0},onZTreeMouseup:function(a,d){var c=b.getSetting(a.data.treeId);e.apply(c.callback.beforeMouseUp,[c.treeId,d],!0)&&e.apply(c.callback.onMouseUp,[a,c.treeId,d]);return!0},onZTreeDblclick:function(a,d){var c=b.getSetting(a.data.treeId);e.apply(c.callback.beforeDblClick,[c.treeId,d],!0)&&e.apply(c.callback.onDblClick,[a,c.treeId,d]);return!0},onZTreeContextmenu:function(a,d){var c=b.getSetting(a.data.treeId);e.apply(c.callback.beforeRightClick,[c.treeId,d],!0)&&e.apply(c.callback.onRightClick,[a,c.treeId,d]);return"function"!=typeof c.callback.onRightClick}},e={apply:function(a,d,b){return"function"==typeof a?a.apply(y,d?d:[]):b},canAsync:function(a,d){var b=a.data.key.children;return a.async.enable&&d&&d.isParent&&!(d.zAsync||d[b]&&0<d[b].length)},clone:function(a){if(null===a)return null;var d=e.isArray(a)?[]:{},b;for(b in a)d[b]=a[b]instanceof Date?new Date(a[b].getTime()):"object"===typeof a[b]?arguments.callee(a[b]):a[b];return d},eqs:function(a,d){return a.toLowerCase()===d.toLowerCase()},isArray:function(a){return"[object Array]"===Object.prototype.toString.apply(a)},$:function(a,d,b){d&&"string"!=typeof d&&(b=d,d="");return"string"==typeof a?z(a,b?b.treeObj.get(0).ownerDocument:null):z("#"+a.tId+d,b?b.treeObj:null)},getMDom:function(a,d,b){if(!d)return null;for(;d&&d.id!==a.treeId;){for(var c=0,f=b.length;d.tagName&&c<f;c++)if(e.eqs(d.tagName,b[c].tagName)&&null!==d.getAttribute(b[c].attrName))return d;d=d.parentNode}return null},getNodeMainDom:function(a){return z(a).parent("li").get(0)||z(a).parentsUntil("li").parent().get(0)},isChildOrSelf:function(a,d){return 0<z(a).closest("#"+d).length},uCanDo:function(a,d){return!0}},f={addNodes:function(a,d,c,g){if(!a.data.keep.leaf||!d||d.isParent)if(e.isArray(c)||(c=[c]),a.data.simpleData.enable&&(c=b.transformTozTreeFormat(a,c)),d){var u=l(d,p.id.SWITCH,a),m=l(d,p.id.ICON,a),k=l(d,p.id.UL,a);d.open||(f.replaceSwitchClass(d,u,p.folder.CLOSE),f.replaceIcoClass(d,m,p.folder.CLOSE),d.open=!1,k.css({display:"none"}));b.addNodesData(a,d,c);f.createNodes(a,d.level+1,c,d);g||f.expandCollapseParentNode(a,d,!0)}else b.addNodesData(a,b.getRoot(a),c),f.createNodes(a,0,c,null)},appendNodes:function(a,d,c,g,u,l){if(!c)return[];for(var e=[],m=a.data.key.children,p=0,k=c.length;p<k;p++){var h=c[p];if(u){var q=(g?g:b.getRoot(a))[m].length==c.length&&0==p;b.initNode(a,d,h,g,q,p==c.length-1,l);b.addNodeCache(a,h)}q=[];h[m]&&0<h[m].length&&(q=f.appendNodes(a,d+1,h[m],h,u,l&&h.open));l&&(f.makeDOMNodeMainBefore(e,a,h),f.makeDOMNodeLine(e,a,h),b.getBeforeA(a,h,e),f.makeDOMNodeNameBefore(e,a,h),b.getInnerBeforeA(a,h,e),f.makeDOMNodeIcon(e,a,h),b.getInnerAfterA(a,h,e),f.makeDOMNodeNameAfter(e,a,h),b.getAfterA(a,h,e),h.isParent&&h.open&&f.makeUlHtml(a,h,e,q.join("")),f.makeDOMNodeMainAfter(e,a,h),b.addCreatedNode(a,h))}return e},appendParentULDom:function(a,d){var b=[],c=l(d,a);!c.get(0)&&d.parentTId&&(f.appendParentULDom(a,d.getParentNode()),c=l(d,a));var e=l(d,p.id.UL,a);e.get(0)&&e.remove();e=f.appendNodes(a,d.level+1,d[a.data.key.children],d,!1,!0);f.makeUlHtml(a,d,b,e.join(""));c.append(b.join(""))},asyncNode:function(a,d,c,g){var u,m;if(d&&!d.isParent)return e.apply(g),!1;if(d&&d.isAjaxing)return!1;if(0==e.apply(a.callback.beforeAsync,[a.treeId,d],!0))return e.apply(g),!1;d&&(d.isAjaxing=!0,l(d,p.id.ICON,a).attr({style:"","class":p.className.BUTTON+" "+p.className.ICO_LOADING}));var k={};u=0;for(m=a.async.autoParam.length;d&&u<m;u++){var h=a.async.autoParam[u].split("\x3d"),q=h;1<h.length&&(q=h[1],h=h[0]);k[q]=d[h]}if(e.isArray(a.async.otherParam))for(u=0,m=a.async.otherParam.length;u<m;u+=2)k[a.async.otherParam[u]]=a.async.otherParam[u+1];else for(var y in a.async.otherParam)k[y]=a.async.otherParam[y];var r=b.getRoot(a)._ver;z.ajax({contentType:a.async.contentType,cache:!1,type:a.async.type,url:e.apply(a.async.url,[a.treeId,d],a.async.url),data:k,dataType:a.async.dataType,success:function(u){if(r==b.getRoot(a)._ver){var l=[];try{l=u&&0!=u.length?"string"==typeof u?eval("("+u+")"):u:[]}catch(m){l=u}d&&(d.isAjaxing=null,d.zAsync=!0);f.setNodeLineIcos(a,d);l&&""!==l?(l=e.apply(a.async.dataFilter,[a.treeId,d,l],l),f.addNodes(a,d,l?e.clone(l):[],!!c)):f.addNodes(a,d,[],!!c);a.treeObj.trigger(p.event.ASYNC_SUCCESS,[a.treeId,d,u]);e.apply(g)}},error:function(c,g,e){r==b.getRoot(a)._ver&&(d&&(d.isAjaxing=null),f.setNodeLineIcos(a,d),a.treeObj.trigger(p.event.ASYNC_ERROR,[a.treeId,d,c,g,e]))}});return!0},cancelPreSelectedNode:function(a,d,c){var g=b.getRoot(a).curSelectedList,f,e;for(f=g.length-1;0<=f;f--)if(e=g[f],d===e||!(d||c&&c===e))if(l(e,p.id.A,a).removeClass(p.node.CURSELECTED),d){b.removeSelectedNode(a,d);break}else g.splice(f,1),a.treeObj.trigger(p.event.UNSELECTED,[a.treeId,e])},createNodeCallback:function(a){if(a.callback.onNodeCreated||a.view.addDiyDom)for(var d=b.getRoot(a);0<d.createdNodes.length;){var c=d.createdNodes.shift();e.apply(a.view.addDiyDom,[a.treeId,c]);a.callback.onNodeCreated&&a.treeObj.trigger(p.event.NODECREATED,[a.treeId,c])}},createNodes:function(a,d,c,g){if(c&&0!=c.length){var e=b.getRoot(a),m=a.data.key.children,m=!g||g.open||!!l(g[m][0],a).get(0);e.createdNodes=[];d=f.appendNodes(a,d,c,g,!0,m);g?(g=l(g,p.id.UL,a),g.get(0)&&g.append(d.join(""))):a.treeObj.append(d.join(""));f.createNodeCallback(a)}},destroy:function(a){a&&(b.initCache(a),b.initRoot(a),c.unbindTree(a),c.unbindEvent(a),a.treeObj.empty(),delete H[a.treeId])},expandCollapseNode:function(a,d,c,g,u){var m=b.getRoot(a),k=a.data.key.children;if(d){if(m.expandTriggerFlag){var h=u;u=function(){h&&h();d.open?a.treeObj.trigger(p.event.EXPAND,[a.treeId,d]):a.treeObj.trigger(p.event.COLLAPSE,[a.treeId,d])};m.expandTriggerFlag=!1}!d.open&&d.isParent&&(!l(d,p.id.UL,a).get(0)||d[k]&&0<d[k].length&&!l(d[k][0],a).get(0))&&(f.appendParentULDom(a,d),f.createNodeCallback(a));if(d.open==c)e.apply(u,[]);else{c=l(d,p.id.UL,a);var m=l(d,p.id.SWITCH,a),q=l(d,p.id.ICON,a);d.isParent?(d.open=!d.open,d.iconOpen&&d.iconClose&&q.attr("style",f.makeNodeIcoStyle(a,d)),d.open?(f.replaceSwitchClass(d,m,p.folder.OPEN),f.replaceIcoClass(d,q,p.folder.OPEN),0==g||""==a.view.expandSpeed?(c.show(),e.apply(u,[])):d[k]&&0<d[k].length?c.slideDown(a.view.expandSpeed,u):(c.show(),e.apply(u,[]))):(f.replaceSwitchClass(d,m,p.folder.CLOSE),f.replaceIcoClass(d,q,p.folder.CLOSE),0!=g&&""!=a.view.expandSpeed&&d[k]&&0<d[k].length?c.slideUp(a.view.expandSpeed,u):(c.hide(),e.apply(u,[])))):e.apply(u,[])}}else e.apply(u,[])},expandCollapseParentNode:function(a,d,b,c,e){d&&(d.parentTId?(f.expandCollapseNode(a,d,b,c),d.parentTId&&f.expandCollapseParentNode(a,d.getParentNode(),b,c,e)):f.expandCollapseNode(a,d,b,c,e))},expandCollapseSonNode:function(a,d,c,g,e){var l=b.getRoot(a),m=a.data.key.children,l=d?d[m]:l[m],m=d?!1:g,k=b.getRoot(a).expandTriggerFlag;b.getRoot(a).expandTriggerFlag=!1;if(l)for(var p=0,h=l.length;p<h;p++)l[p]&&f.expandCollapseSonNode(a,l[p],c,m);b.getRoot(a).expandTriggerFlag=k;f.expandCollapseNode(a,d,c,g,e)},isSelectedNode:function(a,d){if(!d)return!1;var c=b.getRoot(a).curSelectedList,g;for(g=c.length-1;0<=g;g--)if(d===c[g])return!0;return!1},makeDOMNodeIcon:function(a,d,c){var g=b.getNodeName(d,c),g=d.view.nameIsHTML?g:g.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;");a.push("\x3cspan id\x3d'",c.tId,p.id.ICON,"' title\x3d'' treeNode",p.id.ICON," class\x3d'",f.makeNodeIcoClass(d,c),"' style\x3d'",f.makeNodeIcoStyle(d,c),"'\x3e\x3c/span\x3e\x3cspan id\x3d'",c.tId,p.id.SPAN,"'\x3e",g,"\x3c/span\x3e")},makeDOMNodeLine:function(a,d,b){a.push("\x3cspan id\x3d'",b.tId,p.id.SWITCH,"' title\x3d'' class\x3d'",f.makeNodeLineClass(d,b),"' treeNode",p.id.SWITCH,"\x3e\x3c/span\x3e")},makeDOMNodeMainAfter:function(a,b,c){a.push("\x3c/li\x3e")},makeDOMNodeMainBefore:function(a,b,c){a.push("\x3cli id\x3d'",c.tId,"' class\x3d'",p.className.LEVEL,c.level,"' tabindex\x3d'0' hidefocus\x3d'true' treenode\x3e")},makeDOMNodeNameAfter:function(a,b,c){a.push("\x3c/a\x3e")},makeDOMNodeNameBefore:function(a,d,c){var g=b.getNodeTitle(d,c),l=f.makeNodeUrl(d,c),m=f.makeNodeFontCss(d,c),k=[],h;for(h in m)k.push(h,":",m[h],";");a.push("\x3ca id\x3d'",c.tId,p.id.A,"' class\x3d'",p.className.LEVEL,c.level,"' treeNode",p.id.A,' onclick\x3d"',c.click||"",'" ',null!=l&&0<l.length?"href\x3d'"+l+"'":""," target\x3d'",f.makeNodeTarget(c),"' style\x3d'",k.join(""),"'");e.apply(d.view.showTitle,[d.treeId,c],d.view.showTitle)&&g&&a.push("title\x3d'",g.replace(/'/g,"\x26#39;").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;"),"'");a.push("\x3e")},makeNodeFontCss:function(a,b){var c=e.apply(a.view.fontCss,[a.treeId,b],a.view.fontCss);return c&&"function"!=typeof c?c:{}},makeNodeIcoClass:function(a,b){var c=["ico"];b.isAjaxing||(c[0]=(b.iconSkin?b.iconSkin+"_":"")+c[0],b.isParent?c.push(b.open?p.folder.OPEN:p.folder.CLOSE):c.push(p.folder.DOCU));return p.className.BUTTON+" "+c.join("_")},makeNodeIcoStyle:function(a,b){var c=[];if(!b.isAjaxing){var g=b.isParent&&b.iconOpen&&b.iconClose?b.open?b.iconOpen:b.iconClose:b[a.data.key.icon];g&&c.push("background:url(",g,") 0 0 no-repeat;background-size: 16px;");0!=a.view.showIcon&&e.apply(a.view.showIcon,[a.treeId,b],!0)||c.push("width:0px;height:0px;")}return c.join("")},makeNodeLineClass:function(a,b){var c=[];a.view.showLine?0==b.level&&b.isFirstNode&&b.isLastNode?c.push(p.line.ROOT):0==b.level&&b.isFirstNode?c.push(p.line.ROOTS):b.isLastNode?c.push(p.line.BOTTOM):c.push(p.line.CENTER):c.push(p.line.NOLINE);b.isParent?c.push(b.open?p.folder.OPEN:p.folder.CLOSE):c.push(p.folder.DOCU);return f.makeNodeLineClassEx(b)+c.join("_")},makeNodeLineClassEx:function(a){return p.className.BUTTON+" "+p.className.LEVEL+a.level+" "+p.className.SWITCH+" "},makeNodeTarget:function(a){return a.target||"_blank"},makeNodeUrl:function(a,b){var c=a.data.key.url;return b[c]?b[c]:null},makeUlHtml:function(a,b,c,g){c.push("\x3cul id\x3d'",b.tId,p.id.UL,"' class\x3d'",p.className.LEVEL,b.level," ",f.makeUlLineClass(a,b),"' style\x3d'display:",b.open?"block":"none","'\x3e");c.push(g);c.push("\x3c/ul\x3e")},makeUlLineClass:function(a,b){return a.view.showLine&&!b.isLastNode?p.line.LINE:""},removeChildNodes:function(a,c){if(c){var e=a.data.key.children,g=c[e];if(g){for(var m=0,k=g.length;m<k;m++)b.removeNodeCache(a,g[m]);b.removeSelectedNode(a);delete c[e];a.data.keep.parent?l(c,p.id.UL,a).empty():(c.isParent=!1,c.open=!1,e=l(c,p.id.SWITCH,a),g=l(c,p.id.ICON,a),f.replaceSwitchClass(c,e,p.folder.DOCU),f.replaceIcoClass(c,g,p.folder.DOCU),l(c,p.id.UL,a).remove())}}},setFirstNode:function(a,b){var c=a.data.key.children;0<b[c].length&&(b[c][0].isFirstNode=!0)},setLastNode:function(a,b){var c=a.data.key.children,g=b[c].length;0<g&&(b[c][g-1].isLastNode=!0)},removeNode:function(a,c){var e=b.getRoot(a),g=a.data.key.children,m=c.parentTId?c.getParentNode():e;c.isFirstNode=!1;c.isLastNode=!1;c.getPreNode=function(){return null};c.getNextNode=function(){return null};if(b.getNodeCache(a,c.tId)){l(c,a).remove();b.removeNodeCache(a,c);b.removeSelectedNode(a,c);for(var k=0,h=m[g].length;k<h;k++)if(m[g][k].tId==c.tId){m[g].splice(k,1);break}f.setFirstNode(a,m);f.setLastNode(a,m);var q,k=m[g].length;if(!a.data.keep.parent&&0==k)m.isParent=!1,m.open=!1,k=l(m,p.id.UL,a),h=l(m,p.id.SWITCH,a),q=l(m,p.id.ICON,a),f.replaceSwitchClass(m,h,p.folder.DOCU),f.replaceIcoClass(m,q,p.folder.DOCU),k.css("display","none");else if(a.view.showLine&&0<k){var y=m[g][k-1],k=l(y,p.id.UL,a),h=l(y,p.id.SWITCH,a);q=l(y,p.id.ICON,a);m==e?1==m[g].length?f.replaceSwitchClass(y,h,p.line.ROOT):(e=l(m[g][0],p.id.SWITCH,a),f.replaceSwitchClass(m[g][0],e,p.line.ROOTS),f.replaceSwitchClass(y,h,p.line.BOTTOM)):f.replaceSwitchClass(y,h,p.line.BOTTOM);k.removeClass(p.line.LINE)}}},replaceIcoClass:function(a,b,c){if(b&&!a.isAjaxing&&(a=b.attr("class"),void 0!=a)){a=a.split("_");switch(c){case p.folder.OPEN:case p.folder.CLOSE:case p.folder.DOCU:a[a.length-1]=c}b.attr("class",a.join("_"))}},replaceSwitchClass:function(a,b,c){if(b){var g=b.attr("class");if(void 0!=g){g=g.split("_");switch(c){case p.line.ROOT:case p.line.ROOTS:case p.line.CENTER:case p.line.BOTTOM:case p.line.NOLINE:g[0]=f.makeNodeLineClassEx(a)+c;break;case p.folder.OPEN:case p.folder.CLOSE:case p.folder.DOCU:g[1]=c}b.attr("class",g.join("_"));c!==p.folder.DOCU?b.removeAttr("disabled"):b.attr("disabled","disabled")}}},selectNode:function(a,c,e){e||f.cancelPreSelectedNode(a,null,c);l(c,p.id.A,a).addClass(p.node.CURSELECTED);b.addSelectedNode(a,c);a.treeObj.trigger(p.event.SELECTED,[a.treeId,c])},setNodeFontCss:function(a,b){var c=l(b,p.id.A,a),g=f.makeNodeFontCss(a,b);g&&c.css(g)},setNodeLineIcos:function(a,b){if(b){var c=l(b,p.id.SWITCH,a),g=l(b,p.id.UL,a),e=l(b,p.id.ICON,a),m=f.makeUlLineClass(a,b);0==m.length?g.removeClass(p.line.LINE):g.addClass(m);c.attr("class",f.makeNodeLineClass(a,b));b.isParent?c.removeAttr("disabled"):c.attr("disabled","disabled");e.removeAttr("style");e.attr("style",f.makeNodeIcoStyle(a,b));e.attr("class",f.makeNodeIcoClass(a,b))}},setNodeName:function(a,c){var f=b.getNodeTitle(a,c),g=l(c,p.id.SPAN,a);g.empty();a.view.nameIsHTML?g.html(b.getNodeName(a,c)):g.text(b.getNodeName(a,c));e.apply(a.view.showTitle,[a.treeId,c],a.view.showTitle)&&l(c,p.id.A,a).attr("title",f?f:"")},setNodeTarget:function(a,b){l(b,p.id.A,a).attr("target",f.makeNodeTarget(b))},setNodeUrl:function(a,b){var c=l(b,p.id.A,a),g=f.makeNodeUrl(a,b);null==g||0==g.length?c.removeAttr("href"):c.attr("href",g)},switchNode:function(a,b){b.open||!e.canAsync(a,b)?f.expandCollapseNode(a,b,!b.open):a.async.enable?f.asyncNode(a,b)||f.expandCollapseNode(a,b,!b.open):b&&f.expandCollapseNode(a,b,!b.open)}};z.fn.zTree={consts:{className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error",REMOVE:"ztree_remove",SELECTED:"ztree_selected",UNSELECTED:"ztree_unselected"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_z:{tools:e,view:f,event:c,data:b},getZTreeObj:function(a){return(a=b.getZTreeTools(a))?a:null},destroy:function(a){if(a&&0<a.length)f.destroy(b.getSetting(a));else for(var c in H)f.destroy(H[c])},init:function(a,d,m){var g=e.clone(x);z.extend(!0,g,d);g.treeId=a.attr("id");g.treeObj=a;g.treeObj.empty();H[g.treeId]=g;"undefined"===typeof document.body.style.maxHeight&&(g.view.expandSpeed="");b.initRoot(g);a=b.getRoot(g);d=g.data.key.children;m=m?e.clone(e.isArray(m)?m:[m]):[];a[d]=g.data.simpleData.enable?b.transformTozTreeFormat(g,m):m;b.initCache(g);c.unbindTree(g);c.bindTree(g);c.unbindEvent(g);c.bindEvent(g);m={setting:g,addNodes:function(a,b,c){function d(){f.addNodes(g,a,m,1==c)}if(!b)return null;a||(a=null);if(a&&!a.isParent&&g.data.keep.leaf)return null;var m=e.clone(e.isArray(b)?b:[b]);e.canAsync(g,a)?f.asyncNode(g,a,c,d):d();return m},cancelSelectedNode:function(a){f.cancelPreSelectedNode(g,a)},destroy:function(){f.destroy(g)},expandAll:function(a){a=!!a;f.expandCollapseSonNode(g,null,a,!0);return a},expandNode:function(a,c,d,m,k){if(!a||!a.isParent)return null;!0!==c&&!1!==c&&(c=!a.open);if((k=!!k)&&c&&0==e.apply(g.callback.beforeExpand,[g.treeId,a],!0)||k&&!c&&0==e.apply(g.callback.beforeCollapse,[g.treeId,a],!0))return null;c&&a.parentTId&&f.expandCollapseParentNode(g,a.getParentNode(),c,!1);if(c===a.open&&!d)return null;b.getRoot(g).expandTriggerFlag=k;if(!e.canAsync(g,a)&&d)f.expandCollapseSonNode(g,a,c,!0,function(){if(!1!==m)try{l(a,g).focus().blur()}catch(b){}});else if(a.open=!c,f.switchNode(this.setting,a),!1!==m)try{l(a,g).focus().blur()}catch(n){}return c},getNodes:function(){return b.getNodes(g)},getNodeByParam:function(a,c,d){return a?b.getNodeByParam(g,d?d[g.data.key.children]:b.getNodes(g),a,c):null},getNodeByTId:function(a){return b.getNodeCache(g,a)},getNodesByParam:function(a,c,d){return a?b.getNodesByParam(g,d?d[g.data.key.children]:b.getNodes(g),a,c):null},getNodesByParamFuzzy:function(a,c,d){return a?b.getNodesByParamFuzzy(g,d?d[g.data.key.children]:b.getNodes(g),a,c):null},getNodesByFilter:function(a,c,d,e){c=!!c;return a&&"function"==typeof a?b.getNodesByFilter(g,d?d[g.data.key.children]:b.getNodes(g),a,c,e):c?null:[]},getNodeIndex:function(a){if(!a)return null;for(var c=g.data.key.children,d=a.parentTId?a.getParentNode():b.getRoot(g),e=0,m=d[c].length;e<m;e++)if(d[c][e]==a)return e;return-1},getSelectedNodes:function(){for(var a=[],c=b.getRoot(g).curSelectedList,d=0,e=c.length;d<e;d++)a.push(c[d]);return a},isSelectedNode:function(a){return b.isSelectedNode(g,a)},reAsyncChildNodes:function(a,c,d){if(this.setting.async.enable){var e=!a;e&&(a=b.getRoot(g));if("refresh"==c){c=this.setting.data.key.children;for(var m=0,k=a[c]?a[c].length:0;m<k;m++)b.removeNodeCache(g,a[c][m]);b.removeSelectedNode(g);a[c]=[];e?this.setting.treeObj.empty():l(a,p.id.UL,g).empty()}f.asyncNode(this.setting,e?null:a,!!d)}},refresh:function(){this.setting.treeObj.empty();var a=b.getRoot(g),c=a[g.data.key.children];b.initRoot(g);a[g.data.key.children]=c;b.initCache(g);f.createNodes(g,0,a[g.data.key.children])},removeChildNodes:function(a){if(!a)return null;var b=a[g.data.key.children];f.removeChildNodes(g,a);return b?b:null},removeNode:function(a,b){a&&(b=!!b,b&&0==e.apply(g.callback.beforeRemove,[g.treeId,a],!0)||(f.removeNode(g,a),b&&this.setting.treeObj.trigger(p.event.REMOVE,[g.treeId,a])))},selectNode:function(a,b){if(a&&e.uCanDo(g)){b=g.view.selectedMulti&&b;if(a.parentTId)f.expandCollapseParentNode(g,a.getParentNode(),!0,!1,function(){try{l(a,g).focus().blur()}catch(b){}});else try{l(a,g).focus().blur()}catch(c){}f.selectNode(g,a,b)}},transformTozTreeNodes:function(a){return b.transformTozTreeFormat(g,a)},transformToArray:function(a){return b.transformToArrayFormat(g,a)},updateNode:function(a,b){a&&l(a,g).get(0)&&e.uCanDo(g)&&(f.setNodeName(g,a),f.setNodeTarget(g,a),f.setNodeUrl(g,a),f.setNodeLineIcos(g,a),f.setNodeFontCss(g,a))}};a.treeTools=m;b.setZTreeTools(g,m);a[d]&&0<a[d].length?f.createNodes(g,0,a[d]):g.async.enable&&g.async.url&&""!==g.async.url&&f.asyncNode(g);return m}};var y=z.fn.zTree,l=e.$,p=y.consts})(jQuery);(function(z){var H={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},I={check:{enable:!1,autoCheckTrigger:!1,chkStyle:H.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:H.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},E=function(k,a){if(!0===a.chkDisabled)return!1;var b=v.getSetting(k.data.treeId),c=b.data.key.checked;if(0==h.apply(b.callback.beforeCheck,[b.treeId,a],!0))return!0;a[c]=!a[c];r.checkNodeRelation(b,a);c=B(a,t.id.CHECK,b);r.setChkClass(b,c,a);r.repairParentChkClassWithSelf(b,a);b.treeObj.trigger(t.event.CHECK,[k,b.treeId,a]);return!0},x=function(k,a){if(!0===a.chkDisabled)return!1;var b=v.getSetting(k.data.treeId),c=B(a,t.id.CHECK,b);a.check_Focus=!0;r.setChkClass(b,c,a);return!0},q=function(k,a){if(!0===a.chkDisabled)return!1;var b=v.getSetting(k.data.treeId),c=B(a,t.id.CHECK,b);a.check_Focus=!1;r.setChkClass(b,c,a);return!0};z.extend(!0,z.fn.zTree.consts,H);z.extend(!0,z.fn.zTree._z,{tools:{},view:{checkNodeRelation:function(k,a){var b,c,m,e=k.data.key.children,f=k.data.key.checked;b=t.radio;if(k.check.chkStyle==b.STYLE){var h=v.getRadioCheckedList(k);if(a[f])if(k.check.radioType==b.TYPE_ALL){for(c=h.length-1;0<=c;c--)b=h[c],b[f]&&b!=a&&(b[f]=!1,h.splice(c,1),r.setChkClass(k,B(b,t.id.CHECK,k),b),b.parentTId!=a.parentTId&&r.repairParentChkClassWithSelf(k,b));h.push(a)}else for(h=a.parentTId?a.getParentNode():v.getRoot(k),c=0,m=h[e].length;c<m;c++)b=h[e][c],b[f]&&b!=a&&(b[f]=!1,r.setChkClass(k,B(b,t.id.CHECK,k),b));else if(k.check.radioType==b.TYPE_ALL)for(c=0,m=h.length;c<m;c++)if(a==h[c]){h.splice(c,1);break}}else a[f]&&(!a[e]||0==a[e].length||-1<k.check.chkboxType.Y.indexOf("s"))&&r.setSonNodeCheckBox(k,a,!0),a[f]||a[e]&&0!=a[e].length&&!(-1<k.check.chkboxType.N.indexOf("s"))||r.setSonNodeCheckBox(k,a,!1),a[f]&&-1<k.check.chkboxType.Y.indexOf("p")&&r.setParentNodeCheckBox(k,a,!0),!a[f]&&-1<k.check.chkboxType.N.indexOf("p")&&r.setParentNodeCheckBox(k,a,!1)},makeChkClass:function(k,a){var b=k.data.key.checked,c=t.checkbox,m=t.radio,e="",e=!0===a.chkDisabled?c.DISABLED:a.halfCheck?c.PART:k.check.chkStyle==m.STYLE?1>a.check_Child_State?c.FULL:c.PART:a[b]?2===a.check_Child_State||-1===a.check_Child_State?c.FULL:c.PART:1>a.check_Child_State?c.FULL:c.PART,b=k.check.chkStyle+"_"+(a[b]?c.TRUE:c.FALSE)+"_"+e,b=a.check_Focus&&!0!==a.chkDisabled?b+"_"+c.FOCUS:b;return t.className.BUTTON+" "+c.DEFAULT+" "+b},repairAllChk:function(k,a){if(k.check.enable&&k.check.chkStyle===t.checkbox.STYLE)for(var b=k.data.key.checked,c=k.data.key.children,m=v.getRoot(k),e=0,f=m[c].length;e<f;e++){var h=m[c][e];!0!==h.nocheck&&!0!==h.chkDisabled&&(h[b]=a);r.setSonNodeCheckBox(k,h,a)}},repairChkClass:function(k,a){if(a&&(v.makeChkFlag(k,a),!0!==a.nocheck)){var b=B(a,t.id.CHECK,k);r.setChkClass(k,b,a)}},repairParentChkClass:function(k,a){if(a&&a.parentTId){var b=a.getParentNode();r.repairChkClass(k,b);r.repairParentChkClass(k,b)}},repairParentChkClassWithSelf:function(k,a){if(a){var b=k.data.key.children;a[b]&&0<a[b].length?r.repairParentChkClass(k,a[b][0]):r.repairParentChkClass(k,a)}},repairSonChkDisabled:function(k,a,b,c){if(a){var m=k.data.key.children;a.chkDisabled!=b&&(a.chkDisabled=b);r.repairChkClass(k,a);if(a[m]&&c)for(var e=0,f=a[m].length;e<f;e++)r.repairSonChkDisabled(k,a[m][e],b,c)}},repairParentChkDisabled:function(k,a,b,c){a&&(a.chkDisabled!=b&&c&&(a.chkDisabled=b),r.repairChkClass(k,a),r.repairParentChkDisabled(k,a.getParentNode(),b,c))},setChkClass:function(k,a,b){a&&(!0===b.nocheck?a.hide():a.show(),a.attr("class",r.makeChkClass(k,b)))},setParentNodeCheckBox:function(k,a,b,c){var m=k.data.key.children,e=k.data.key.checked,f=B(a,t.id.CHECK,k);c||(c=a);v.makeChkFlag(k,a);!0!==a.nocheck&&!0!==a.chkDisabled&&(a[e]=b,r.setChkClass(k,f,a),k.check.autoCheckTrigger&&a!=c&&k.treeObj.trigger(t.event.CHECK,[null,k.treeId,a]));if(a.parentTId){f=!0;if(!b)for(var m=a.getParentNode()[m],h=0,l=m.length;h<l;h++)if(!0!==m[h].nocheck&&!0!==m[h].chkDisabled&&m[h][e]||(!0===m[h].nocheck||!0===m[h].chkDisabled)&&0<m[h].check_Child_State){f=!1;break}f&&r.setParentNodeCheckBox(k,a.getParentNode(),b,c)}},setSonNodeCheckBox:function(k,a,b,c){if(a){var m=k.data.key.children,e=k.data.key.checked,f=B(a,t.id.CHECK,k);c||(c=a);var h=!1;if(a[m])for(var l=0,p=a[m].length;l<p&&!0!==a.chkDisabled;l++){var n=a[m][l];r.setSonNodeCheckBox(k,n,b,c);!0===n.chkDisabled&&(h=!0)}a!=v.getRoot(k)&&!0!==a.chkDisabled&&(h&&!0!==a.nocheck&&v.makeChkFlag(k,a),!0!==a.nocheck&&!0!==a.chkDisabled?(a[e]=b,h||(a.check_Child_State=a[m]&&0<a[m].length?b?2:0:-1)):a.check_Child_State=-1,r.setChkClass(k,f,a),k.check.autoCheckTrigger&&a!=c&&!0!==a.nocheck&&!0!==a.chkDisabled&&k.treeObj.trigger(t.event.CHECK,[null,k.treeId,a]))}}},event:{},data:{getRadioCheckedList:function(k){for(var a=v.getRoot(k).radioCheckedList,b=0,c=a.length;b<c;b++)v.getNodeCache(k,a[b].tId)||(a.splice(b,1),b--,c--);return a},getCheckStatus:function(k,a){if(!k.check.enable||a.nocheck||a.chkDisabled)return null;var b=k.data.key.checked;return{checked:a[b],half:a.halfCheck?a.halfCheck:k.check.chkStyle==t.radio.STYLE?2===a.check_Child_State:a[b]?-1<a.check_Child_State&&2>a.check_Child_State:0<a.check_Child_State}},getTreeCheckedNodes:function(k,a,b,c){if(!a)return[];var m=k.data.key.children,e=k.data.key.checked,f=b&&k.check.chkStyle==t.radio.STYLE&&k.check.radioType==t.radio.TYPE_ALL;c=c?c:[];for(var h=0,l=a.length;h<l&&(!0===a[h].nocheck||!0===a[h].chkDisabled||a[h][e]!=b||(c.push(a[h]),!f))&&!(v.getTreeCheckedNodes(k,a[h][m],b,c),f&&0<c.length);h++);return c},getTreeChangeCheckedNodes:function(h,a,b){if(!a)return[];var c=h.data.key.children,m=h.data.key.checked;b=b?b:[];for(var e=0,f=a.length;e<f;e++)!0!==a[e].nocheck&&!0!==a[e].chkDisabled&&a[e][m]!=a[e].checkedOld&&b.push(a[e]),v.getTreeChangeCheckedNodes(h,a[e][c],b);return b},makeChkFlag:function(h,a){if(a){var b=h.data.key.children,c=h.data.key.checked,m=-1;if(a[b])for(var e=0,f=a[b].length;e<f;e++){var q=a[b][e],l=-1;if(h.check.chkStyle==t.radio.STYLE)if(l=!0===q.nocheck||!0===q.chkDisabled?q.check_Child_State:!0===q.halfCheck?2:q[c]?2:0<q.check_Child_State?2:0,2==l){m=2;break}else 0==l&&(m=0);else if(h.check.chkStyle==t.checkbox.STYLE)if(l=!0===q.nocheck||!0===q.chkDisabled?q.check_Child_State:!0===q.halfCheck?1:q[c]?-1===q.check_Child_State||2===q.check_Child_State?2:1:0<q.check_Child_State?1:0,1===l){m=1;break}else if(2===l&&-1<m&&0<e&&l!==m){m=1;break}else if(2===m&&-1<l&&2>l){m=1;break}else-1<l&&(m=l)}a.check_Child_State=m}}}});z=z.fn.zTree;var h=z._z.tools,t=z.consts,r=z._z.view,v=z._z.data,B=h.$;v.exSetting(I);v.addInitBind(function(k){k.treeObj.bind(t.event.CHECK,function(a,b,c,m){a.srcEvent=b;h.apply(k.callback.onCheck,[a,c,m])})});v.addInitUnBind(function(h){h.treeObj.unbind(t.event.CHECK)});v.addInitCache(function(h){});v.addInitNode(function(k,a,b,c,m,e,f){b&&(a=k.data.key.checked,"string"==typeof b[a]&&(b[a]=h.eqs(b[a],"true")),b[a]=!!b[a],b.checkedOld=b[a],"string"==typeof b.nocheck&&(b.nocheck=h.eqs(b.nocheck,"true")),b.nocheck=!!b.nocheck||k.check.nocheckInherit&&c&&!!c.nocheck,"string"==typeof b.chkDisabled&&(b.chkDisabled=h.eqs(b.chkDisabled,"true")),b.chkDisabled=!!b.chkDisabled||k.check.chkDisabledInherit&&c&&!!c.chkDisabled,"string"==typeof b.halfCheck&&(b.halfCheck=h.eqs(b.halfCheck,"true")),b.halfCheck=!!b.halfCheck,b.check_Child_State=-1,b.check_Focus=!1,b.getCheckStatus=function(){return v.getCheckStatus(k,b)},k.check.chkStyle==t.radio.STYLE&&k.check.radioType==t.radio.TYPE_ALL&&b[a]&&v.getRoot(k).radioCheckedList.push(b))});v.addInitProxy(function(k){var a=k.target,b=v.getSetting(k.data.treeId),c="",m=null,e="",f=null;h.eqs(k.type,"mouseover")?b.check.enable&&h.eqs(a.tagName,"span")&&null!==a.getAttribute("treeNode"+t.id.CHECK)&&(c=h.getNodeMainDom(a).id,e="mouseoverCheck"):h.eqs(k.type,"mouseout")?b.check.enable&&h.eqs(a.tagName,"span")&&null!==a.getAttribute("treeNode"+t.id.CHECK)&&(c=h.getNodeMainDom(a).id,e="mouseoutCheck"):h.eqs(k.type,"click")&&b.check.enable&&h.eqs(a.tagName,"span")&&null!==a.getAttribute("treeNode"+t.id.CHECK)&&(c=h.getNodeMainDom(a).id,e="checkNode");if(0<c.length)switch(m=v.getNodeCache(b,c),e){case "checkNode":f=E;break;case "mouseoverCheck":f=x;break;case "mouseoutCheck":f=q}return{stop:"checkNode"===e,node:m,nodeEventType:e,nodeEventCallback:f,treeEventType:"",treeEventCallback:null}},!0);v.addInitRoot(function(h){v.getRoot(h).radioCheckedList=[]});v.addBeforeA(function(h,a,b){h.check.enable&&(v.makeChkFlag(h,a),b.push("\x3cspan ID\x3d'",a.tId,t.id.CHECK,"' class\x3d'",r.makeChkClass(h,a),"' treeNode",t.id.CHECK,!0===a.nocheck?" style\x3d'display:none;'":"","\x3e\x3c/span\x3e"))});v.addZTreeTools(function(k,a){a.checkNode=function(a,b,e,f){var k=this.setting.data.key.checked;!0!==a.chkDisabled&&(!0!==b&&!1!==b&&(b=!a[k]),f=!!f,a[k]===b&&!e||f&&0==h.apply(this.setting.callback.beforeCheck,[this.setting.treeId,a],!0)||!h.uCanDo(this.setting)||!this.setting.check.enable||!0===a.nocheck||(a[k]=b,b=B(a,t.id.CHECK,this.setting),(e||this.setting.check.chkStyle===t.radio.STYLE)&&r.checkNodeRelation(this.setting,a),r.setChkClass(this.setting,b,a),r.repairParentChkClassWithSelf(this.setting,a),f&&this.setting.treeObj.trigger(t.event.CHECK,[null,this.setting.treeId,a])))};a.checkAllNodes=function(a){r.repairAllChk(this.setting,!!a)};a.getCheckedNodes=function(a){var b=this.setting.data.key.children;a=!1!==a;return v.getTreeCheckedNodes(this.setting,v.getRoot(this.setting)[b],a)};a.getChangeCheckedNodes=function(){var a=this.setting.data.key.children;return v.getTreeChangeCheckedNodes(this.setting,v.getRoot(this.setting)[a])};a.setChkDisabled=function(a,b,e,f){b=!!b;e=!!e;r.repairSonChkDisabled(this.setting,a,b,!!f);r.repairParentChkDisabled(this.setting,a.getParentNode(),b,e)};var b=a.updateNode;a.updateNode=function(c,m){b&&b.apply(a,arguments);if(c&&this.setting.check.enable&&B(c,this.setting).get(0)&&h.uCanDo(this.setting)){var e=B(c,t.id.CHECK,this.setting);1!=m&&this.setting.check.chkStyle!==t.radio.STYLE||r.checkNodeRelation(this.setting,c);r.setChkClass(this.setting,e,c);r.repairParentChkClassWithSelf(this.setting,c)}}});var M=r.createNodes;r.createNodes=function(h,a,b,c){M&&M.apply(r,arguments);b&&r.repairParentChkClassWithSelf(h,c)};var K=r.removeNode;r.removeNode=function(h,a){var b=a.getParentNode();K&&K.apply(r,arguments);a&&b&&(r.repairChkClass(h,b),r.repairParentChkClass(h,b))};var L=r.appendNodes;r.appendNodes=function(h,a,b,c,m,e){var f="";L&&(f=L.apply(r,arguments));c&&v.makeChkFlag(h,c);return f}})(jQuery);(function(z){var H={event:{DRAG:"ztree_drag",DROP:"ztree_drop",RENAME:"ztree_rename",DRAGMOVE:"ztree_dragmove"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},I={onHoverOverNode:function(a,b){var c=t.getSetting(a.data.treeId),m=t.getRoot(c);if(m.curHoverNode!=b)I.onHoverOutNode(a);m.curHoverNode=b;h.addHoverDom(c,b)},onHoverOutNode:function(a,b){var c=t.getSetting(a.data.treeId),m=t.getRoot(c);m.curHoverNode&&!t.isSelectedNode(c,m.curHoverNode)&&(h.removeTreeDom(c,m.curHoverNode),m.curHoverNode=null)},onMousedownNode:function(a,b){function c(a){if(0==p.dragFlag&&Math.abs(U-a.clientX)<l.edit.drag.minMoveSize&&Math.abs(V-a.clientY)<l.edit.drag.minMoveSize)return!0;var b,c,d,e,f;f=l.data.key.children;B.css("cursor","pointer");if(0==p.dragFlag){if(0==x.apply(l.callback.beforeDrag,[l.treeId,g],!0))return m(a),!0;b=0;for(c=g.length;b<c;b++)0==b&&(p.dragNodeShowBefore=[]),d=g[b],d.isParent&&d.open?(h.expandCollapseNode(l,d,!d.open),p.dragNodeShowBefore[d.tId]=!0):p.dragNodeShowBefore[d.tId]=!1;p.dragFlag=1;n.showHoverDom=!1;x.showIfameMask(l,!0);d=!0;e=-1;if(1<g.length){var k=g[0].parentTId?g[0].getParentNode()[f]:t.getNodes(l);f=[];b=0;for(c=k.length;b<c;b++)if(void 0!==p.dragNodeShowBefore[k[b].tId]&&(d&&-1<e&&e+1!==b&&(d=!1),f.push(k[b]),e=b),g.length===f.length){g=f;break}}d&&(K=g[0].getPreNode(),L=g[g.length-1].getNextNode());O=r("\x3cul class\x3d'zTreeDragUL'\x3e\x3c/ul\x3e",l);b=0;for(c=g.length;b<c;b++)d=g[b],d.editNameFlag=!1,h.selectNode(l,d,0<b),h.removeTreeDom(l,d),b>l.edit.drag.maxShowNodeNum-1||(e=r("\x3cli id\x3d'"+d.tId+"_tmp'\x3e\x3c/li\x3e",l),e.append(r(d,q.id.A,l).clone()),e.css("padding","0"),e.children("#"+d.tId+q.id.A).removeClass(q.node.CURSELECTED),O.append(e),b==l.edit.drag.maxShowNodeNum-1&&(e=r("\x3cli id\x3d'"+d.tId+"_moretmp'\x3e\x3ca\x3e  ...  \x3c/a\x3e\x3c/li\x3e",l),O.append(e)));O.attr("id",g[0].tId+q.id.UL+"_tmp");O.addClass(l.treeObj.attr("class"));O.appendTo(B);J=r("\x3cspan class\x3d'tmpzTreeMove_arrow'\x3e\x3c/span\x3e",l);J.attr("id","zTreeMove_arrow_tmp");J.appendTo(B);l.treeObj.trigger(q.event.DRAG,[a,l.treeId,g])}if(1==p.dragFlag){A&&J.attr("id")==a.target.id&&C&&a.clientX+u.scrollLeft()+2>z("#"+C+q.id.A,A).offset().left?(d=z("#"+C+q.id.A,A),a.target=0<d.length?d.get(0):a.target):A&&(A.removeClass(q.node.TMPTARGET_TREE),C&&z("#"+C+q.id.A,A).removeClass(q.node.TMPTARGET_NODE+"_"+q.move.TYPE_PREV).removeClass(q.node.TMPTARGET_NODE+"_"+H.move.TYPE_NEXT).removeClass(q.node.TMPTARGET_NODE+"_"+H.move.TYPE_INNER));C=A=null;I=!1;w=l;d=t.getSettings();for(var y in d)d[y].treeId&&d[y].edit.enable&&d[y].treeId!=l.treeId&&(a.target.id==d[y].treeId||0<z(a.target).parents("#"+d[y].treeId).length)&&(I=!0,w=d[y]);y=u.scrollTop();e=u.scrollLeft();f=w.treeObj.offset();b=w.treeObj.get(0).scrollHeight;d=w.treeObj.get(0).scrollWidth;c=a.clientY+y-f.top;var v=w.treeObj.height()+f.top-a.clientY-y,G=a.clientX+e-f.left,E=w.treeObj.width()+f.left-a.clientX-e;f=c<l.edit.drag.borderMax&&c>l.edit.drag.borderMin;var k=v<l.edit.drag.borderMax&&v>l.edit.drag.borderMin,Q=G<l.edit.drag.borderMax&&G>l.edit.drag.borderMin,P=E<l.edit.drag.borderMax&&E>l.edit.drag.borderMin,v=c>l.edit.drag.borderMin&&v>l.edit.drag.borderMin&&G>l.edit.drag.borderMin&&E>l.edit.drag.borderMin,G=f&&0>=w.treeObj.scrollTop(),E=k&&w.treeObj.scrollTop()+w.treeObj.height()+10>=b,W=Q&&0>=w.treeObj.scrollLeft(),X=P&&w.treeObj.scrollLeft()+w.treeObj.width()+10>=d;if(a.target&&x.isChildOrSelf(a.target,w.treeId)){for(var N=a.target;N&&N.tagName&&!x.eqs(N.tagName,"li")&&N.id!=w.treeId;)N=N.parentNode;var R=!0;b=0;for(c=g.length;b<c;b++)if(d=g[b],N.id===d.tId){R=!1;break}else if(0<r(d,l).find("#"+N.id).length){R=!1;break}R&&a.target&&x.isChildOrSelf(a.target,N.id+q.id.A)&&(A=z(N),C=N.id)}d=g[0];v&&x.isChildOrSelf(a.target,w.treeId)&&(!A&&(a.target.id==w.treeId||G||E||W||X)&&(I||!I&&d.parentTId)&&(A=w.treeObj),f?w.treeObj.scrollTop(w.treeObj.scrollTop()-10):k&&w.treeObj.scrollTop(w.treeObj.scrollTop()+10),Q?w.treeObj.scrollLeft(w.treeObj.scrollLeft()-10):P&&w.treeObj.scrollLeft(w.treeObj.scrollLeft()+10),A&&A!=w.treeObj&&A.offset().left<w.treeObj.offset().left&&w.treeObj.scrollLeft(w.treeObj.scrollLeft()+A.offset().left-w.treeObj.offset().left));O.css({top:a.clientY+y+3+"px",left:a.clientX+e+3+"px"});f=b=0;if(A&&A.attr("id")!=w.treeId){var F=null==C?null:t.getNodeCache(w,C);c=(a.ctrlKey||a.metaKey)&&l.edit.drag.isMove&&l.edit.drag.isCopy||!l.edit.drag.isMove&&l.edit.drag.isCopy;b=!(!K||C!==K.tId);f=!(!L||C!==L.tId);e=d.parentTId&&d.parentTId==C;d=(c||!f)&&x.apply(w.edit.drag.prev,[w.treeId,g,F],!!w.edit.drag.prev);b=(c||!b)&&x.apply(w.edit.drag.next,[w.treeId,g,F],!!w.edit.drag.next);P=(c||!e)&&!(w.data.keep.leaf&&!F.isParent)&&x.apply(w.edit.drag.inner,[w.treeId,g,F],!!w.edit.drag.inner);if(d||b||P){c=z("#"+C+q.id.A,A);f=F.isLastNode?null:z("#"+F.getNextNode().tId+q.id.A,A.next());k=c.offset().top;e=c.offset().left;Q=d?P?.25:b?.5:1:-1;P=b?P?.75:d?.5:0:-1;y=(a.clientY+y-k)/c.height();(1==Q||y<=Q&&-.2<=y)&&d?(b=1-J.width(),f=k-J.height()/2,D=q.move.TYPE_PREV):(0==P||y>=P&&1.2>=y)&&b?(b=1-J.width(),f=null==f||F.isParent&&F.open?k+c.height()-J.height()/2:f.offset().top-J.height()/2,D=q.move.TYPE_NEXT):(b=5-J.width(),f=k,D=q.move.TYPE_INNER);J.css({display:"block",top:f+"px",left:e+b+"px"});c.addClass(q.node.TMPTARGET_NODE+"_"+D);if(M!=C||S!=D)T=(new Date).getTime();F&&F.isParent&&D==q.move.TYPE_INNER&&(y=!0,window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==F.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===F.tId&&(y=!1),y&&(window.zTreeMoveTimer=setTimeout(function(){D==q.move.TYPE_INNER&&F&&F.isParent&&!F.open&&(new Date).getTime()-T>w.edit.drag.autoOpenTime&&x.apply(w.callback.beforeDragOpen,[w.treeId,F],!0)&&(h.switchNode(w,F),w.edit.drag.autoExpandTrigger&&w.treeObj.trigger(q.event.EXPAND,[w.treeId,F]))},w.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=F.tId))}else A=null,C="",D=q.move.TYPE_INNER,J.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null)}else D=q.move.TYPE_INNER,A&&x.apply(w.edit.drag.inner,[w.treeId,g,null],!!w.edit.drag.inner)?A.addClass(q.node.TMPTARGET_TREE):A=null,J.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null);M=C;S=D;l.treeObj.trigger(q.event.DRAGMOVE,[a,l.treeId,g])}return!1}function m(a){window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null);S=M=null;u.unbind("mousemove",c);u.unbind("mouseup",m);u.unbind("selectstart",e);B.css("cursor","auto");A&&(A.removeClass(q.node.TMPTARGET_TREE),C&&z("#"+C+q.id.A,A).removeClass(q.node.TMPTARGET_NODE+"_"+q.move.TYPE_PREV).removeClass(q.node.TMPTARGET_NODE+"_"+H.move.TYPE_NEXT).removeClass(q.node.TMPTARGET_NODE+"_"+H.move.TYPE_INNER));x.showIfameMask(l,!1);n.showHoverDom=!0;if(0!=p.dragFlag){p.dragFlag=0;var b,d,f;b=0;for(d=g.length;b<d;b++)f=g[b],f.isParent&&p.dragNodeShowBefore[f.tId]&&!f.open&&(h.expandCollapseNode(l,f,!f.open),delete p.dragNodeShowBefore[f.tId]);O&&O.remove();J&&J.remove();var k=(a.ctrlKey||a.metaKey)&&l.edit.drag.isMove&&l.edit.drag.isCopy||!l.edit.drag.isMove&&l.edit.drag.isCopy;!k&&A&&C&&g[0].parentTId&&C==g[0].parentTId&&D==q.move.TYPE_INNER&&(A=null);if(A){b=function(){if(I){if(!k)for(var b=0,c=g.length;b<c;b++)h.removeNode(l,g[b]);if(D==q.move.TYPE_INNER)h.addNodes(w,y,v);else if(h.addNodes(w,y.getParentNode(),v),D==q.move.TYPE_PREV)for(b=0,c=v.length;b<c;b++)h.moveNode(w,y,v[b],D,!1);else for(b=-1,c=v.length-1;b<c;c--)h.moveNode(w,y,v[c],D,!1)}else if(k&&D==q.move.TYPE_INNER)h.addNodes(w,y,v);else if(k&&h.addNodes(w,y.getParentNode(),v),D!=q.move.TYPE_NEXT)for(b=0,c=v.length;b<c;b++)h.moveNode(w,y,v[b],D,!1);else for(b=-1,c=v.length-1;b<c;c--)h.moveNode(w,y,v[c],D,!1);h.selectNodes(w,v);r(v[0],l).focus().blur();l.treeObj.trigger(q.event.DROP,[a,w.treeId,v,y,D,k])};var y=null==C?null:t.getNodeCache(w,C);if(0==x.apply(l.callback.beforeDrop,[w.treeId,g,y,D,k],!0))h.selectNodes(E,g);else{var v=k?x.clone(g):g;D==q.move.TYPE_INNER&&x.canAsync(w,y)?h.asyncNode(w,y,!1,b):b()}}else h.selectNodes(E,g),l.treeObj.trigger(q.event.DROP,[a,l.treeId,g,null,null,null])}}function e(){return!1}var f,k,l=t.getSetting(a.data.treeId),p=t.getRoot(l),n=t.getRoots();if(2==a.button||!l.edit.enable||!l.edit.drag.isCopy&&!l.edit.drag.isMove)return!0;var d=a.target,v=t.getRoot(l).curSelectedList,g=[];if(t.isSelectedNode(l,b))for(f=0,k=v.length;f<k;f++){if(v[f].editNameFlag&&x.eqs(d.tagName,"input")&&null!==d.getAttribute("treeNode"+q.id.INPUT))return!0;g.push(v[f]);if(g[0].parentTId!==v[f].parentTId){g=[b];break}}else g=[b];h.editNodeBlur=!0;h.cancelCurEditNode(l);var u=z(l.treeObj.get(0).ownerDocument),B=z(l.treeObj.get(0).ownerDocument.body),O,J,A,I=!1,w=l,E=l,K,L,M=null,S=null,C=null,D=q.move.TYPE_INNER,U=a.clientX,V=a.clientY,T=(new Date).getTime();x.uCanDo(l)&&u.bind("mousemove",c);u.bind("mouseup",m);u.bind("selectstart",e);a.preventDefault&&a.preventDefault();return!0}};z.extend(!0,z.fn.zTree.consts,H);z.extend(!0,z.fn.zTree._z,{tools:{getAbs:function(a){a=a.getBoundingClientRect();return[a.left+(document.body.scrollLeft+document.documentElement.scrollLeft),a.top+(document.body.scrollTop+document.documentElement.scrollTop)]},inputFocus:function(a){a.get(0)&&(a.focus(),x.setCursorPosition(a.get(0),a.val().length))},inputSelect:function(a){a.get(0)&&(a.focus(),a.select())},setCursorPosition:function(a,b){if(a.setSelectionRange)a.focus(),a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0);c.moveEnd("character",b);c.moveStart("character",b);c.select()}},showIfameMask:function(a,b){for(var c=t.getRoot(a);0<c.dragMaskList.length;)c.dragMaskList[0].remove(),c.dragMaskList.shift();if(b)for(var m=r("iframe",a),e=0,f=m.length;e<f;e++){var h=m.get(e),l=x.getAbs(h),h=r("\x3cdiv id\x3d'zTreeMask_"+e+"' class\x3d'zTreeMask' style\x3d'top:"+l[1]+"px; left:"+l[0]+"px; width:"+h.offsetWidth+"px; height:"+h.offsetHeight+"px;'\x3e\x3c/div\x3e",a);h.appendTo(r("body",a));c.dragMaskList.push(h)}}},view:{addEditBtn:function(a,b){if(!(b.editNameFlag||0<r(b,q.id.EDIT,a).length)&&x.apply(a.edit.showRenameBtn,[a.treeId,b],a.edit.showRenameBtn)){var c=r(b,q.id.A,a),m="\x3cspan class\x3d'"+q.className.BUTTON+" edit' id\x3d'"+b.tId+q.id.EDIT+"' title\x3d'"+x.apply(a.edit.renameTitle,[a.treeId,b],a.edit.renameTitle)+"' treeNode"+q.id.EDIT+" style\x3d'display:none;'\x3e\x3c/span\x3e";c.append(m);r(b,q.id.EDIT,a).bind("click",function(){if(!x.uCanDo(a)||0==x.apply(a.callback.beforeEditName,[a.treeId,b],!0))return!1;h.editNode(a,b);return!1}).show()}},addRemoveBtn:function(a,b){if(!(b.editNameFlag||0<r(b,q.id.REMOVE,a).length)&&x.apply(a.edit.showRemoveBtn,[a.treeId,b],a.edit.showRemoveBtn)){var c=r(b,q.id.A,a),m="\x3cspan class\x3d'"+q.className.BUTTON+" remove' id\x3d'"+b.tId+q.id.REMOVE+"' title\x3d'"+x.apply(a.edit.removeTitle,[a.treeId,b],a.edit.removeTitle)+"' treeNode"+q.id.REMOVE+" style\x3d'display:none;'\x3e\x3c/span\x3e";c.append(m);r(b,q.id.REMOVE,a).bind("click",function(){if(!x.uCanDo(a)||0==x.apply(a.callback.beforeRemove,[a.treeId,b],!0))return!1;h.removeNode(a,b);a.treeObj.trigger(q.event.REMOVE,[a.treeId,b]);return!1}).bind("mousedown",function(a){return!0}).show()}},addHoverDom:function(a,b){t.getRoots().showHoverDom&&(b.isHover=!0,a.edit.enable&&(h.addEditBtn(a,b),h.addRemoveBtn(a,b)),x.apply(a.view.addHoverDom,[a.treeId,b]))},cancelCurEditNode:function(a,b,c){var m=t.getRoot(a),e=a.data.key.name,f=m.curEditNode;if(f){var k=m.curEditInput;b=b?b:c?f[e]:k.val();if(!1===x.apply(a.callback.beforeRename,[a.treeId,f,b,c],!0))return!1;f[e]=b;r(f,q.id.A,a).removeClass(q.node.CURSELECTED_EDIT);k.unbind();h.setNodeName(a,f);f.editNameFlag=!1;m.curEditNode=null;m.curEditInput=null;h.selectNode(a,f,!1);a.treeObj.trigger(q.event.RENAME,[a.treeId,f,c])}return m.noSelection=!0},editNode:function(a,b){var c=t.getRoot(a);h.editNodeBlur=!1;if(t.isSelectedNode(a,b)&&c.curEditNode==b&&b.editNameFlag)setTimeout(function(){x.inputFocus(c.curEditInput)},0);else{var m=a.data.key.name;b.editNameFlag=!0;h.removeTreeDom(a,b);h.cancelCurEditNode(a);h.selectNode(a,b,!1);r(b,q.id.SPAN,a).html("\x3cinput type\x3dtext class\x3d'rename' id\x3d'"+b.tId+q.id.INPUT+"' treeNode"+q.id.INPUT+" \x3e");var e=r(b,q.id.INPUT,a);e.attr("value",b[m]);a.edit.editNameSelectAll?x.inputSelect(e):x.inputFocus(e);e.bind("blur",function(b){h.editNodeBlur||h.cancelCurEditNode(a)}).bind("keydown",function(b){"13"==b.keyCode?(h.editNodeBlur=!0,h.cancelCurEditNode(a)):"27"==b.keyCode&&h.cancelCurEditNode(a,null,!0)}).bind("click",function(a){return!1}).bind("dblclick",function(a){return!1});r(b,q.id.A,a).addClass(q.node.CURSELECTED_EDIT);c.curEditInput=e;c.noSelection=!1;c.curEditNode=b}},moveNode:function(a,b,c,m,e,f){var k=t.getRoot(a),l=a.data.key.children;if(b!=c&&(!a.data.keep.leaf||!b||b.isParent||m!=q.move.TYPE_INNER)){var p=c.parentTId?c.getParentNode():k,n=null===b||b==k;n&&null===b&&(b=k);n&&(m=q.move.TYPE_INNER);k=b.parentTId?b.getParentNode():k;m!=q.move.TYPE_PREV&&m!=q.move.TYPE_NEXT&&(m=q.move.TYPE_INNER);m==q.move.TYPE_INNER&&(n?c.parentTId=null:(b.isParent||(b.isParent=!0,b.open=!!b.open,h.setNodeLineIcos(a,b)),c.parentTId=b.tId));var d;n?d=n=a.treeObj:(f||m!=q.move.TYPE_INNER?f||h.expandCollapseNode(a,b.getParentNode(),!0,!1):h.expandCollapseNode(a,b,!0,!1),n=r(b,a),d=r(b,q.id.UL,a),n.get(0)&&!d.get(0)&&(d=[],h.makeUlHtml(a,b,d,""),n.append(d.join(""))),d=r(b,q.id.UL,a));var v=r(c,a);v.get(0)?n.get(0)||v.remove():v=h.appendNodes(a,c.level,[c],null,!1,!0).join("");d.get(0)&&m==q.move.TYPE_INNER?d.append(v):n.get(0)&&m==q.move.TYPE_PREV?n.before(v):n.get(0)&&m==q.move.TYPE_NEXT&&n.after(v);var g=-1,u=0,x=null,n=null,z=c.level;if(c.isFirstNode)g=0,1<p[l].length&&(x=p[l][1],x.isFirstNode=!0);else if(c.isLastNode)g=p[l].length-1,x=p[l][g-1],x.isLastNode=!0;else for(d=0,v=p[l].length;d<v;d++)if(p[l][d].tId==c.tId){g=d;break}0<=g&&p[l].splice(g,1);if(m!=q.move.TYPE_INNER)for(d=0,v=k[l].length;d<v;d++)k[l][d].tId==b.tId&&(u=d);m==q.move.TYPE_INNER?(b[l]||(b[l]=[]),0<b[l].length&&(n=b[l][b[l].length-1],n.isLastNode=!1),b[l].splice(b[l].length,0,c),c.isLastNode=!0,c.isFirstNode=1==b[l].length):b.isFirstNode&&m==q.move.TYPE_PREV?(k[l].splice(u,0,c),n=b,n.isFirstNode=!1,c.parentTId=b.parentTId,c.isFirstNode=!0,c.isLastNode=!1):b.isLastNode&&m==q.move.TYPE_NEXT?(k[l].splice(u+1,0,c),n=b,n.isLastNode=!1,c.parentTId=b.parentTId,c.isFirstNode=!1,c.isLastNode=!0):(m==q.move.TYPE_PREV?k[l].splice(u,0,c):k[l].splice(u+1,0,c),c.parentTId=b.parentTId,c.isFirstNode=!1,c.isLastNode=!1);t.fixPIdKeyValue(a,c);t.setSonNodeLevel(a,c.getParentNode(),c);h.setNodeLineIcos(a,c);h.repairNodeLevelClass(a,c,z);!a.data.keep.parent&&1>p[l].length?(p.isParent=!1,p.open=!1,b=r(p,q.id.UL,a),m=r(p,q.id.SWITCH,a),l=r(p,q.id.ICON,a),h.replaceSwitchClass(p,m,q.folder.DOCU),h.replaceIcoClass(p,l,q.folder.DOCU),b.css("display","none")):x&&h.setNodeLineIcos(a,x);n&&h.setNodeLineIcos(a,n);a.check&&a.check.enable&&h.repairChkClass&&(h.repairChkClass(a,p),h.repairParentChkClassWithSelf(a,p),p!=c.parent&&h.repairParentChkClassWithSelf(a,c));f||h.expandCollapseParentNode(a,c.getParentNode(),!0,e)}},removeEditBtn:function(a,b){r(b,q.id.EDIT,a).unbind().remove()},removeRemoveBtn:function(a,b){r(b,q.id.REMOVE,a).unbind().remove()},removeTreeDom:function(a,b){b.isHover=!1;h.removeEditBtn(a,b);h.removeRemoveBtn(a,b);x.apply(a.view.removeHoverDom,[a.treeId,b])},repairNodeLevelClass:function(a,b,c){if(c!==b.level){var m=r(b,a),e=r(b,q.id.A,a);a=r(b,q.id.UL,a);c=q.className.LEVEL+c;b=q.className.LEVEL+b.level;m.removeClass(c);m.addClass(b);e.removeClass(c);e.addClass(b);a.removeClass(c);a.addClass(b)}},selectNodes:function(a,b){for(var c=0,m=b.length;c<m;c++)h.selectNode(a,b[c],0<c)}},event:{},data:{setSonNodeLevel:function(a,b,c){if(c){var m=a.data.key.children;c.level=b?b.level+1:0;if(c[m]){b=0;for(var e=c[m].length;b<e;b++)c[m][b]&&t.setSonNodeLevel(a,c,c[m][b])}}}}});var E=z.fn.zTree,x=E._z.tools,q=E.consts,h=E._z.view,t=E._z.data,r=x.$;t.exSetting({edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}});t.addInitBind(function(a){var b=a.treeObj,c=q.event;b.bind(c.RENAME,function(b,c,f,h){x.apply(a.callback.onRename,[b,c,f,h])});b.bind(c.DRAG,function(b,c,f,h){x.apply(a.callback.onDrag,[c,f,h])});b.bind(c.DRAGMOVE,function(b,c,f,h){x.apply(a.callback.onDragMove,[c,f,h])});b.bind(c.DROP,function(b,c,f,h,l,k,n){x.apply(a.callback.onDrop,[c,f,h,l,k,n])})});t.addInitUnBind(function(a){a=a.treeObj;var b=q.event;a.unbind(b.RENAME);a.unbind(b.DRAG);a.unbind(b.DRAGMOVE);a.unbind(b.DROP)});t.addInitCache(function(a){});t.addInitNode(function(a,b,c,h,e,f,k){c&&(c.isHover=!1,c.editNameFlag=!1)});t.addInitProxy(function(a){var b=a.target,c=t.getSetting(a.data.treeId),h=a.relatedTarget,e="",f=null,k="",l=null,p=null;if(x.eqs(a.type,"mouseover")){if(p=x.getMDom(c,b,[{tagName:"a",attrName:"treeNode"+q.id.A}]))e=x.getNodeMainDom(p).id,k="hoverOverNode"}else x.eqs(a.type,"mouseout")?(p=x.getMDom(c,h,[{tagName:"a",attrName:"treeNode"+q.id.A}]),p||(e="remove",k="hoverOutNode")):x.eqs(a.type,"mousedown")&&(p=x.getMDom(c,b,[{tagName:"a",attrName:"treeNode"+q.id.A}]))&&(e=x.getNodeMainDom(p).id,k="mousedownNode");if(0<e.length)switch(f=t.getNodeCache(c,e),k){case "mousedownNode":l=I.onMousedownNode;break;case "hoverOverNode":l=I.onHoverOverNode;break;case "hoverOutNode":l=I.onHoverOutNode}return{stop:!1,node:f,nodeEventType:k,nodeEventCallback:l,treeEventType:"",treeEventCallback:null}});t.addInitRoot(function(a){a=t.getRoot(a);var b=t.getRoots();a.curEditNode=null;a.curEditInput=null;a.curHoverNode=null;a.dragFlag=0;a.dragNodeShowBefore=[];a.dragMaskList=[];b.showHoverDom=!0});t.addZTreeTools(function(a,b){b.cancelEditName=function(a){t.getRoot(this.setting).curEditNode&&h.cancelCurEditNode(this.setting,a?a:null,!0)};b.copyNode=function(a,b,e,f){if(!b||a&&!a.isParent&&this.setting.data.keep.leaf&&e===q.move.TYPE_INNER)return null;var k=this,l=x.clone(b);a||(a=null,e=q.move.TYPE_INNER);e==q.move.TYPE_INNER?(b=function(){h.addNodes(k.setting,a,[l],f)},x.canAsync(this.setting,a)?h.asyncNode(this.setting,a,f,b):b()):(h.addNodes(this.setting,a.parentNode,[l],f),h.moveNode(this.setting,a,l,e,!1,f));return l};b.editName=function(a){a&&a.tId&&a===t.getNodeCache(this.setting,a.tId)&&(a.parentTId&&h.expandCollapseParentNode(this.setting,a.getParentNode(),!0),h.editNode(this.setting,a))};b.moveNode=function(a,b,e,f){function k(){h.moveNode(l.setting,a,b,e,!1,f)}if(!b)return b;if(a&&!a.isParent&&this.setting.data.keep.leaf&&e===q.move.TYPE_INNER||a&&(b.parentTId==a.tId&&e==q.move.TYPE_INNER||0<r(b,this.setting).find("#"+a.tId).length))return null;a||(a=null);var l=this;x.canAsync(this.setting,a)&&e===q.move.TYPE_INNER?h.asyncNode(this.setting,a,f,k):k();return b};b.setEditable=function(a){this.setting.edit.enable=a;return this.refresh()}});var v=h.cancelPreSelectedNode;h.cancelPreSelectedNode=function(a,b){for(var c=t.getRoot(a).curSelectedList,k=0,e=c.length;k<e;k++)if(!b||b===c[k])if(h.removeTreeDom(a,c[k]),b)break;v&&v.apply(h,arguments)};var B=h.createNodes;h.createNodes=function(a,b,c,k){B&&B.apply(h,arguments);c&&h.repairParentChkClassWithSelf&&h.repairParentChkClassWithSelf(a,k)};var M=h.makeNodeUrl;h.makeNodeUrl=function(a,b){return a.edit.enable?null:M.apply(h,arguments)};var K=h.removeNode;h.removeNode=function(a,b){var c=t.getRoot(a);c.curEditNode===b&&(c.curEditNode=null);K&&K.apply(h,arguments)};var L=h.selectNode;h.selectNode=function(a,b,c){var k=t.getRoot(a);if(t.isSelectedNode(a,b)&&k.curEditNode==b&&b.editNameFlag)return!1;L&&L.apply(h,arguments);h.addHoverDom(a,b);return!0};var k=x.uCanDo;x.uCanDo=function(a,b){var c=t.getRoot(a);if(b&&(x.eqs(b.type,"mouseover")||x.eqs(b.type,"mouseout")||x.eqs(b.type,"mousedown")||x.eqs(b.type,"mouseup")))return!0;c.curEditNode&&(h.editNodeBlur=!1,c.curEditInput.focus());return!c.curEditNode&&(k?k.apply(h,arguments):!0)}})(jQuery);